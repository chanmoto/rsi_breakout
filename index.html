<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.js"></script>
    <script type="text/javascript" src="https://github.com/nagix/chartjs-plugin-streaming/releases/download/v1.2.0/chartjs-plugin-streaming.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pusher/4.1.0/pusher.js"></script>


</head>

  <body class="flex wait center">
    <div>  
      <h1 class="inline">Chart the Stock Market</h1>
      <h3>Stocks other people add will show up here in real time - four stocks maximum - to remove a stock click the label</h3>
      <canvas id="stockCanvas"></canvas>
      <div class="flex">
        <input id="symbolInput" type="text" placeholder="enter stock symbol">
        <div class="btn" id="getStockBtn">get stock</div>
      </div>
      <h4>Note: The free tier of the stock api has a maximum of five requests/minute and 500 requests/day</h4>
    </div>
  </body>

</html>



<script>
    let outputElement = document.getElementById('output_csv');

function getCsvData(dataPath) {
 const request = new XMLHttpRequest();
 request.addEventListener('load', (event) => {
  const response = event.target.responseText;
  array = convertArray(response.replace(/"/g,""));
  plot(array);
  console.log();
 });
 request.open('GET', dataPath, true);
 request.send();
}

function convertArray(data) {
 var dataArray = [];
 var dataString = data.split('\n');
// dataString = dataString.replace('"',"");


 for (let i = 0; i < dataString.length; i++) {
  dataArray[i] = dataString[i].split(',');
  dataArray[i] = dataArray[i].shift();
 }
 return dataArray
}

getCsvData('./03_EURUSD_D.csv');

function plot(data){
  var myChart = new Chart(document.getElementById("stockCanvas"), {
  type: 'line',
  data: data,
    options: {
        responsive: false,
    }
  }
)}

</script>
